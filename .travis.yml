sudo: false

os:
  - linux

osx_image: xcode9.4
dist: bionic

matrix:
  allow_failures:
    - os: osx

branches:
  only:
  - travis_setup

language: cpp

env:
  global:
    - secure: ""

before_install:
  - chmod +x Travis/build_linux.sh
  - chmod +x Travis/build_osx.sh

addons:
  apt:
    packages:
    - python3
    - python3-pip
    - python3-setuptools
    - cmake
    - libmysqlclient-dev
    - autoconf
    - libtool
    - yasm
    - nasm
    - g++

  homebrew:
    packages:
    - python3
    - cmake
    - mysql-connector-c
    - mysql-connector-c++
    - automake
    - libtool
    - nasm
    - yasm
    - xz
    - pkg-config

install:
  - sudo -H pip3 install wget requests pathlib
  - sudo apt build-dep -qq qt5-default || true

script:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then Travis/build_linux.sh ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then Travis/build_osx.sh ; fi

cache:
    apt: true
    directories:
    - $HOME/build/BlockSettle/3rd/release
    - $HOME/build/BlockSettle/3rd/release-shared
